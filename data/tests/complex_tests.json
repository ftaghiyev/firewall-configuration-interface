[
  {
    "id": "complex_block_malicious",
    "description": "Block Malicious IPs from accessing Any zone",
    "context_file": "complex-network.json",
    "nl_query": "Block Malicious_IPs from accessing Any",
    "expected_ir": {
      "rules": [
        {
          "id": "r1",
          "action": "deny",
          "src": ["Malicious_IPs"],
          "dst": ["Any"],
          "protocol": "any",
          "dst_ports": [],
          "src_zone": "Untrust",
          "dst_zone": "Any",
          "direction": null,
          "schedule": null,
          "log": false,
          "priority": 10
        }
      ],
      "metadata": {
        "raw_policy": "Block Malicious_IPs from accessing Any",
        "warnings": [],
        "context_used": true
      }
    },
    "expected_cli": "set rulebase security rules r1 from Untrust\nset rulebase security rules r1 to Any\nset rulebase security rules r1 source Malicious_IPs\nset rulebase security rules r1 destination Any\nset rulebase security rules r1 service application-default\nset rulebase security rules r1 action deny"
  },
  {
    "id": "complex_hq_pci",
    "description": "Allow HQ Users to access PCI Servers on SQL",
    "context_file": "complex-network.json",
    "nl_query": "Allow HQ_User_Net to access PCI_Servers on SQL_Server",
    "expected_ir": {
      "rules": [
        {
          "id": "r1",
          "action": "allow",
          "src": ["HQ_User_Net"],
          "dst": ["PCI_Servers"],
          "protocol": "tcp",
          "dst_ports": [1433],
          "src_zone": "Trust-Corp",
          "dst_zone": "PCI-Zone",
          "direction": "internal",
          "schedule": null,
          "log": false,
          "priority": 100
        }
      ],
      "metadata": {
        "raw_policy": "Allow HQ_User_Net to access PCI_Servers on SQL_Server",
        "warnings": [],
        "context_used": true
      }
    },
    "expected_cli": "set rulebase security rules r1 from \"Trust-Corp\"\nset rulebase security rules r1 to \"PCI-Zone\"\nset rulebase security rules r1 source HQ_User_Net\nset rulebase security rules r1 destination PCI_Servers\nset rulebase security rules r1 service tcp_1433\nset rulebase security rules r1 action allow"
  },
  {
    "id": "complex_guest_internet",
    "description": "Allow Guest WiFi to Internet on HTTP/S",
    "context_file": "complex-network.json",
    "nl_query": "Allow Guest_WiFi_Range to access Any on HTTP and HTTPS",
    "expected_ir": {
      "rules": [
        {
          "id": "r1",
          "action": "allow",
          "src": ["Guest_WiFi_Range"],
          "dst": ["Any"],
          "protocol": "tcp",
          "dst_ports": [80],
          "src_zone": "Guest-Zone",
          "dst_zone": "Untrust",
          "direction": "outbound",
          "schedule": null,
          "log": false,
          "priority": 100
        },
        {
          "id": "r2",
          "action": "allow",
          "src": ["Guest_WiFi_Range"],
          "dst": ["Any"],
          "protocol": "tcp",
          "dst_ports": [443],
          "src_zone": "Guest-Zone",
          "dst_zone": "Untrust",
          "direction": "outbound",
          "schedule": null,
          "log": false,
          "priority": 100
        }
      ],
      "metadata": {
        "raw_policy": "Allow Guest_WiFi_Range to access Any on HTTP and HTTPS",
        "warnings": [],
        "context_used": true
      }
    },
    "expected_cli": "set rulebase security rules r1 from \"Guest-Zone\"\nset rulebase security rules r1 to Untrust\nset rulebase security rules r1 source Guest_WiFi_Range\nset rulebase security rules r1 destination Any\nset rulebase security rules r1 service tcp_80\nset rulebase security rules r1 action allow\n\nset rulebase security rules r2 from \"Guest-Zone\"\nset rulebase security rules r2 to Untrust\nset rulebase security rules r2 source Guest_WiFi_Range\nset rulebase security rules r2 destination Any\nset rulebase security rules r2 service application-default\nset rulebase security rules r2 action allow"
  }
]

